version: "1.0"

# Databases
databases:
    - analytics:
        shared: no

    - raw:
        shared: no

    - snowflake:
        shared: yes


# Roles
roles:
    ## Admin Roles
    - accountadmin:
        warehouses:
            - loading
        member_of:
            - sysadmin

    - securityadmin:
        warehouses:
            - loading
        member_of:
            - sysadmin

    - sysadmin:
        warehouses:
            - loading
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                write:
                    - raw
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analytics.*
                write:
                    - raw.*
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                write:
                    - raw.*.*
                    - analytics.*.*

    ## Regular Roles
    - analyst_growth:
        warehouses:
            - analyst_xs
            - analyst_xl
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                    - snowflake
                write:
                    - analytics
            schemas:
                read:
                    - raw.gcloud_postgres_stitch
                    - raw.salesforce_stitch
                    - raw.sheetload
                    - raw.snowplow
                    - raw.tap_postgres
                    - raw.zuora_stitch
                    - analytics.analytics
                    - analytics.analytics_staging
                    - analytics.analytics_meta
                    - analytics.dbt_archive
                    - snowflake.*
            tables:
                read:
                    - raw.gcloud_postgres_stitch.*
                    - raw.netsuite_stitch.*
                    - raw.salesforce_stitch.*
                    - raw.sheetload.*
                    - raw.snowplow.*
                    - raw.tap_postgres.*
                    - raw.zuora_stitch.*
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - analytics.analytics_meta.*
                    - analytics.dbt_archive.*
                    - snowflake.*.*

    - analyst_finance:
        warehouses:
            - analyst_xs
            - analyst_xl
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                    - snowflake
                write:
                    - analytics
            schemas:
                read:
                    - raw.bamboohr
                    - raw.gcloud_postgres_stitch
                    - raw.netsuite_stitch
                    - raw.salesforce_stitch
                    - raw.sheetload
                    - raw.snowplow
                    - raw.tap_postgres
                    - raw.zuora_stitch
                    - analytics.analytics
                    - analytics.analytics_staging
                    - analytics.analytics_meta
                    - analytics.dbt_archive
                    - snowflake.*
            tables:
                read:
                    - raw.bamboohr.*
                    - raw.gcloud_postgres_stitch.*
                    - raw.netsuite_stitch.*
                    - raw.salesforce_stitch.*
                    - raw.sheetload.*
                    - raw.snowplow.*
                    - raw.tap_postgres.*
                    - raw.zuora_stitch.*
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - analytics.analytics_meta.*
                    - analytics.dbt_archive.*
                    - snowflake.*.*

    - analyst_core:
        warehouses:
            - analyst_xs
            - analyst_xl
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                    - snowflake
                write:
                    - analytics
            schemas:
                read:
                    - raw.gcloud_postgres_stitch
                    - raw.netsuite_stitch
                    - raw.salesforce_stitch
                    - raw.sheetload
                    - raw.snowplow
                    - raw.tap_postgres
                    - raw.zendesk_stitch
                    - raw.zuora_stitch
                    - analytics.analytics
                    - analytics.analytics_staging
                    - analytics.analytics_meta
                    - analytics.dbt_archive
                    - snowflake.*
            tables:
                read:
                    - raw.gcloud_postgres_stitch.*
                    - raw.netsuite_stitch.*
                    - raw.salesforce_stitch.*
                    - raw.sheetload.*
                    - raw.snowplow.*
                    - raw.tap_postgres.*
                    - raw.zendesk_stitch.*
                    - raw.zuora_stitch.*
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - analytics.analytics_meta.*
                    - analytics.dbt_archive.*
                    - snowflake.*.*

    - analyst_sensitive:
        warehouses:
            - analyst_xs
            - analyst_xl
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                    - snowflake
                write:
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analytics.*
                    - snowflake.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                    - snowflake.*.*

    - engineer:
        warehouses:
            - loading
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                    - snowflake
                write:
                    - raw
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analytics.*
                    - snowflake.*
                write:
                    - raw.*
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                    - snowflake.*.*
                write:
                    - raw.*.*
                    - analytics.*.*

    - intern:
        warehouses:
            - analyst_xs
            - analyst_xl
        privileges:
            databases:
                read:
                    - analytics
                    - snowflake
                write:
                    - analytics
            schemas:
                read:
                    - analytics.analytics
                    - analytics.analytics_staging
                    - analytics.analytics_meta
                    - snowflake.*
            tables:
                read:
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - analytics.analytics_meta.*
                    - snowflake.*.*

    - loader:
        warehouses:
            - loading
        owns:
            schemas:
                - raw.*
            tables:
                - raw.*.*
        privileges:
            databases:
                read:
                    - raw
                write:
                    - raw
            schemas:
                read:
                    - raw.*
                write:
                    - raw.*
            tables:
                read:
                    - raw.*.*
                write:
                    - raw.*.*

    - product_manager:
        warehouses:
            - reporting
        privileges:
            databases:
                read:
                    - analytics
                    - raw
            schemas:
                read:
                    - analytics.analytics
                    - analytics.analytics_staging
                    - raw.snowplow
                    - raw.tap_postgres
            tables:
                read:
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - raw.snowplow.*
                    - raw.tap_postgres.*

    - reporter:
        warehouses:
            - reporting
        privileges:
            databases:
                read:
                    - analytics
                    - snowflake
            schemas:
                read:
                    - analytics.analytics
                    - analytics.analytics_meta
                    - snowflake.account_usage

            tables:
                read:
                    - analytics.analytics.*
                    - analytics.analytics_meta.*
                    - snowflake.account_usage.*

    - reporter_staging:
        warehouses:
            - reporting
        privileges:
            databases:
                read:
                    - analytics
                    - snowflake
            schemas:
                read:
                    - analytics.analytics
                    - analytics.analytics_staging
                    - analytics.analytics_meta
                    - snowflake.*

            tables:
                read:
                    - analytics.analytics.*
                    - analytics.analytics_staging.*
                    - analytics.analytics_meta.*
                    - snowflake.*.*

    - reporter_sensitive: #Right now this matches the reporter role, until we roll out the sensitive schema
        warehouses:
            - reporting
        privileges:
            databases:
                read:
                    - analytics
                    - snowflake
            schemas:
                read:
                    - analytics.analytics
                    - analytics.analytics_meta
                    - snowflake.*

            tables:
                read:
                    - analytics.analytics.*
                    - analytics.analytics_meta.*
                    - snowflake.*.*

    - transformer: # For automated jobs
        warehouses:
            - transforming_s
            - transforming_xl
            - transforming_xs
        owns:
            schemas:
                - analytics.*
            tables:
                - analytics.*.*
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                write:
                    - analytics
            schemas:
                read:
                    - raw.*
                write:
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                write:
                    - analytics.*.*

    # User Roles
    - acarella:
        warehouses:
            - reporting

    - airflow:
        warehouses:
            - gitlab_postgres
            - loading
            - transforming_xs
            - transforming_s
            - transforming_l
            - transforming_xl

    - agroleau:
        warehouses:
            - reporting

    - amrvaljevich:
        warehouses:
            - analyst_xs
            - analyst_xl

    - dtang:
        warehouses:
            - reporting

    - eburke:
        warehouses:
            - engineer_xs
            - engineer_xl
            - loading
            - reporting

    - ehannon:
        warehouses:
            - analyst_xs
            - analyst_xl

    - eeastwood:
        warehouses:
            - reporting
        privileges:
            databases:
                read:
                    - raw
            schemas:
                read:
                    - raw.gitter
                write:
                    - raw.gitter
            tables:
                read:
                    - raw.gitter.*
                write:
                    - raw.gitter.*

    - ekastelein:
        warehouses:
            - analyst_xs
            - analyst_xl

    - gitlab_ci:
        warehouses:
            - loading
            - merge_request_xs
            - merge_request_xl
            - reporting
            - transforming_xs
            - transforming_xl

    - iroussos:
        warehouses:
            - reporting

    - iweeks:
        warehouses:
            - analyst_xs
            - analyst_xl

    - jsalazar:
        warehouses:
            - reporting

    - jurbanc:
        warehouses:
            - reporting

    - jwatson:
        warehouses:
            - reporting

    - ksmith:
        warehouses:
            - reporting

    - mrodriguez:
        warehouses:
            - reporting

    - mpeychet:
        warehouses:
            - analyst_xs
            - analyst_xl

    - periscope:
        warehouses:
            - reporting

    - periscope_sensitive:
        warehouses:
            - reporting

    - periscope_staging:
        warehouses:
            - reporting

    - permission_bot:
        warehouses:
            - admin

    - speters:
        warehouses:
            - reporting

    - ssichak:
        warehouses:
            - reporting

    - stitch:
        warehouses:
            - stitch

    - tlapiana:
        warehouses:
            - engineer_xs
            - engineer_xl
            - loading
            - reporting

    - tmurphy:
        warehouses:
            - engineer_xs
            - engineer_xl
            - loading
            - reporting

    - valexieva:
        warehouses:
            - reporting

    - wwright:
        warehouses:
            - analyst_xs
            - analyst_xl
            - reporting


# Users
users:
    - acarella:
        can_login: yes
        member_of:
            - acarella
            - securityadmin
            - sysadmin

    - agroleau:
        can_login: yes
        member_of:
            - agroleau
            - reporter

    - airflow:
        can_login: yes
        member_of:
            - airflow
            - loader
            - reporter
            - sysadmin
            - transformer

    - amrvaljevich:
        can_login: yes
        member_of:
            - amrvaljevich
            - analyst_core

    - dtang:
        can_login: yes
        member_of:
            - dtang
            - reporter

    - eburke:
        can_login: yes
        member_of:
            - analyst_sensitive
            - eburke
            - engineer
            - sysadmin

    - eeastwood:
        can_login: yes
        member_of:
            - eeastwood
            - reporter

    - ehannon:
        can_login: yes
        member_of:
            - ehannon
            - intern
            - reporter

    - ekastelein:
        can_login: yes
        member_of:
            - ekastelein
            - analyst_growth

    - gitlab_ci:
        can_login: yes
        member_of:
            - gitlab_ci
            - loader
            - reporter
            - sysadmin
            - transformer

    - iroussos:
        can_login: yes
        member_of:
            - iroussos
            - reporter

    - iweeks:
        can_login: yes
        member_of:
            - iweeks
            - analyst_finance

    - jsalazar:
        can_login: yes
        member_of:
            - jsalazar
            - securityadmin
            - sysadmin

    - jurbanc:
        can_login: yes
        member_of:
            - jurbanc
            - securityadmin
            - sysadmin

    - jwatson:
        can_login: yes
        member_of:
            - jwatson
            - product_manager
            - reporter

    - ksmith:
        can_login: yes
        member_of:
            - ksmith
            - securityadmin
            - sysadmin

    - mpeychet:
        can_login: yes
        member_of:
            - mpeychet
            - analyst_growth

    - mrodriguez:
        can_login: yes
        member_of:
            - mrodriguez
            - reporter

    - periscope:
        can_login: yes
        member_of:
            - periscope
            - reporter

    - periscope_sensitive:
        can_login: yes
        member_of:
            - periscope_sensitive
            - reporter_sensitive

    - periscope_staging:
        can_login: yes
        member_of:
            - periscope_staging
            - reporter_staging

    - permission_bot:
        can_login: yes
        member_of:
            - permission_bot
            - securityadmin

    - speters:
        can_login: yes
        member_of:
            - securityadmin
            - speters
            - sysadmin

    - ssichak:
        can_login: yes
        member_of:
            - securityadmin
            - ssichak
            - sysadmin

    - stitch:
        can_login: yes
        member_of:
            - stitch
            - loader

    - tlapiana:
        can_login: yes
        member_of:
            - engineer
            - tlapiana
            - sysadmin

    - tmurphy:
        can_login: yes
        member_of:
            - accountadmin
            - engineer
            - securityadmin
            - sysadmin
            - tmurphy

    - valexieva:
        can_login: yes
        member_of:
            - product_manager
            - reporter
            - valexieva

    - wwright:
        can_login: yes
        member_of:
            - analyst_finance
            - wwright

# Warehouses
warehouses:
    - admin:
        size: x-small

    - analyst_xl:
        size: x-large

    - analyst_xs:
        size: x-small

    - engineer_xl:
        size: x-large

    - engineer_xs:
        size: x-small

    - gitlab_postgres:
        size: x-small

    - loading:
        size: x-small

    - merge_request_xl:
        size: x-large

    - merge_request_xs:
        size: x-small

    - reporting:
        size: x-small

    - stitch:
        size: x-small

    - transforming_s:
        size: small

    - transforming_l:
        size: large

    - transforming_xl:
        size: x-large
    
    - transforming_xs:
        size: x-small
        